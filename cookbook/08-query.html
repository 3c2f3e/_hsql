<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>_hsql Query Demo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.3/sql-wasm.js" integrity="sha512-+6Q7hv5pGUBXOuHWw8OdQx3ac7DzM3oJhYqz7SHDku0yl9EBdMqegoPed4GsHRoNF/VQYK2LTYewAIEBrEf/3w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/hyperscript" src="./08-query._hs"></script>
    <script src="https://unpkg.com/hyperscript.org"></script>
    <script src="https://cdn.jsdelivr.net/gh/3c2f3e/_hsql/index.min.js"></script>
    <link rel="stylesheet" href="../css/index.css">
  </head>
  <body>
    <a href="https://github.com/3c2f3e/_hsql/blob/www/cookbook/08-query.html">View recipe in Cookbook</a>
    <h1>_hsql Query Demo</h1>
    <button 
      _=  "on click 
      put '' into #results
      db 'DROP TABLE IF EXISTS users'
      db 'CREATE TABLE users (firstname CHAR(50) NOT NULL, lastname CHAR(50) NOT NULL, age INT(50) NOT NULL)'
      put `[${Date.now()}] Table created successfully. Add records by updating inputs and clicking Insert.` into #results
      catch error
      put `<p style='color:red;'>${error}</p>` at the end of #results
      "
    >
    Create Table
    </button>
    <p><label for="firstname">First name:</label> <input type="text" id="firstname" value="John"></p>
    <p><label for="lastname">Last name:</label> <input type="text" id="lastname" value="Doe"></p>
    <p><label for="age">Age:</label> <input type="number" id="age" value="27"></p>
    <button 
      _=  "on click
      put '' into #results
      -- set record to [#firstname's value, #lastname's value, #age's value as a Number]
      set record to {'$firstname':#firstname's value, '$lastname':#lastname's value, '$age':#age's value as a Number}
      insert('users',record, true, 10)
      end
      "
    >
    Insert
    </button>
    <hr />
    <div id="results" _= "
      -- Listen for changes in value
      -- on db:insert[dbvalues[0][0]=='John'] from body
      -- Listen for changes in a specific key
      on db:insert[dbcolumns[0]=='firstname'] from body
      -- Listen for changes on a table
      -- on db:insert[table=='users'] from body
      table [event.detail.output]
      put it at the end of me
      end
    "
    >
    Click Create Table to create the users table.
    </div>
  </body>
</html>
